<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>LunarCannon by Ahmet YILDIRIM</title>
<script src="js/jquery.js"></script>
<script src="js/raphael-min.js"></script>
<link rel="stylesheet" href="jquery.mobile-1.1.0.min.css" />
<script src="jquery.mobile-1.1.0.min.js"></script>
<script>
/**
 * jQuery.browser.mobile (http://detectmobilebrowser.com/)
 *
 * jQuery.browser.mobile will be true if the browser is a mobile device
 *
 **/
(function(a){jQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);

</script>

<script>
items=[];
n=0;
path=[];
hits=0;
function init()
{
	   tempx=parseInt(bomb.attr('cx'));
	   tempy=parseInt(bomb.attr('cy'));
	   bomb.attr('cx',bomb.attr('cx')+bomb.spx);
	   bomb.attr('cy',bomb.attr('cy')+bomb.spy);
	   
	   aymerkezx=ay.attr("x")+ay.attr("width")/2;
	   aymerkezy=ay.attr("y")+ay.attr("height")/2
	   aycap=ay.attr("height")/2
	   hip=Math.sqrt( Math.pow( parseInt(bomb.attr('cx'))-aymerkezx,2 )+Math.pow( parseInt(bomb.attr('cy'))-aymerkezy,2)  );
	   	   
	   ufox=ufo.attr("x")+ufo.attr("width")/2;
	   ufoy=ufo.attr("y")+ufo.attr("height")/2
	   ufocap=ufo.attr("height")/2
	   ufohip=Math.sqrt( Math.pow( parseInt(bomb.attr('cx'))-ufox,2 )+Math.pow( parseInt(bomb.attr('cy'))-ufoy,2)  );

	   cs=(parseInt(bomb.attr('cx')-aymerkezx))*aycap*20/(hip*hip);
	   sn=(parseInt(bomb.attr('cy')-aymerkezy))*aycap*20/(hip*hip);
	   aci=Math.atan((bomb.spy)/(bomb.spx))*180/Math.PI;
		if((bomb.spx)<0)
		{
			aci+=180;
		}
	   bombfire.rotate(aci-90,true);
	   var hiptemp=Math.sqrt(Math.pow(bomb.spx,2)+Math.pow(bomb.spy,2));
	   var sintemp=bomb.spy/hiptemp;
	   var costemp=bomb.spx/hiptemp;
	   bombfire.attr("x",parseInt(bomb.attr('cx'))-costemp*10-bombfire.attr("width")/2);
	   bombfire.attr("y",parseInt(bomb.attr('cy'))-sintemp*10-bombfire.attr("height")/2);
	   if(ufohip<ufocap+bomb.cap)
	   {
			hits++;
			$("#nhits").html(hits);
			var t=paper.image('fire.gif',parseInt(bomb.attr('cx'))-costemp*10-10, parseInt(bomb.attr('cy'))-sintemp*10-20, 20, 40);
			t.rotate(aci-90);
			temizle();
			$.mobile.changePage('#hit', 'pop', true, true);
			setTimeout(function()
			{
			$("#hit").dialog('close');
			},1000);
	   }
	   if(hip>bomb.cap+aycap)
	   {
		bomb.spx-=cs;
		bomb.spy-=sn;   
	   }
	   else if(hip<bomb.cap+aycap)
	   {
		bomb.spx+=cs;
		bomb.spy+sn; 
		var t=paper.image('fire.gif',parseInt(bomb.attr('cx'))-costemp*10-10, parseInt(bomb.attr('cy'))-sintemp*10-20, 20, 40);
		aci=Math.atan((parseInt(bomb.attr('cy'))-aymerkezy)/(parseInt(bomb.attr('cx'))-aymerkezx))*180/Math.PI;
		if((parseInt(bomb.attr('cx'))-aymerkezx)<0)
		{
			aci+=180;
		}
		aci+=180;
		t.rotate(aci-90);
		temizle();
			$.mobile.changePage('#damn', 'pop', true, true);
			setTimeout(function()
			{
			$('#damn').dialog('close');
			},1000);
	   }
	   path.push(paper.path("M"+tempx+" "+tempy+"L"+ bomb.attr('cx')+" "+ bomb.attr('cy')+"").attr({fill:'#FFF',"stroke-width":5,stroke: "#fff", opacity: 1}));
		timeleft-=0.1;
		$("#time").html(parseInt(timeleft));
		if(parseFloat(timeleft)<=0)
		{			
			temizle();
			$.mobile.changePage('#missed', 'pop', true, true);
			setTimeout(function()
			{
			$('#missed').dialog('close');
			},1000);
		}
}
function sinus(d)
{
	return Math.sin(Raphael.rad(d));
}
function bbox(obje)
{
ow=obje.attr('width');
oh=obje.attr('height');
alfa=obje._.rt.deg;
return {w:sinus(alfa)*oh+sinus(90-alfa)*ow,h:sinus(90-alfa)*oh+sinus(alfa)*ow};
}
function temizle()
{
	timeleft=10;
	$("#time").html(parseFloat(timeleft));
	for(x in path) 
	{
	path[x].remove()
	}
	if(bomb!=null)
	{
	bomb.remove();
	bombfire.remove();
	}
	if(intervalid!=0)
	{
	clearInterval(intervalid);
	}
	if(target!=null)
	{
	target.remove();
	}
}
target=null;
window.onload=function()
{
	timeleft=10;
	paper = Raphael("canvas", "100%", "100%");
	paper.image('earth.png',0, $("#canvas").height()-127, 200, 127);
	ay=paper.image('moon.png',$("#canvas").width()/3, $("#canvas").height()/4, $("#canvas").width()/10, $("#canvas").width()/10);
	
	indic=null;
	intervalid=null;
	iop={
		x1:0,
		y1:0,
		x2:0,
		y2:0
	};
	down=false;
	//paper.circle(350+aycap, 150+aycap, aycap).attr({fill:'#EE8515', stroke: "none", opacity: 1});
	ay.cap=75;
	bomb=null;
	ufo=paper.image('ufo.png',$("#canvas").width()*3/4,$("#canvas").height()/2, $("#canvas").width()*5/50, $("#canvas").width()*2/50);
	lw=$("#canvas").width()*50/100;
	lh=$("#canvas").height()*20/100;
	lx=-1*lw/2+100;
	ly=$("#canvas").height()-lh-50;
	launcher=paper.image("cannon.png",lx,ly,lw,lh);
	ayak=paper.image("ayak.png",lx+lw/2-lw/4+lw*10/100,ly+lh*56/100-lh*3/10,lw/4, lh);
	document.addEventListener(jQuery.browser.mobile?'touchstart':"mousedown", function(e) {
    e.preventDefault();
			down=true;
			temizle();
			if(jQuery.browser.mobile)
			{
			x=e.touches[0].pageX;
			y=e.touches[0].pageY;				
			}
			else
			{
			x=e.pageX;
			y=e.pageY;
			}
			target=paper.image('target.png',x, y, 200, 200);
			iop.x1=(lx+lw/2)+sinus(90-launcher._.rt.deg)*lw/(20);
			iop.y1=(ly+lh/2)+sinus(launcher._.rt.deg)*lw/(20);
	}, false);
	document.addEventListener(jQuery.browser.mobile?'touchmove':'mousemove', function(e) {
    e.preventDefault();
			if(down)
			{
				if(jQuery.browser.mobile)
				{
				iop.x2=e.touches[0].pageX;
				iop.y2=e.touches[0].pageY;				
				}
				else
				{
				iop.x2=e.pageX;
				iop.y2=e.pageY;
				}
				iop.x1=(lx+lw/2)+sinus(90-launcher._.rt.deg)*lw/(20);
				iop.y1=(ly+lh/2)+sinus(launcher._.rt.deg)*lw/(20);
				$("#thrust").html(parseInt(Math.sqrt(Math.pow((iop.x2-iop.x1)/20,2)+Math.pow((iop.y2-iop.y1)/20,2))));
				aci=Math.atan((iop.y2-iop.y1)/(iop.x2-iop.x1))*180/Math.PI;
				if((iop.x2-iop.x1)<=0)
				{
				aci+=180;
				}
				$("#angle").html(-1*parseInt(aci-360)%360);
				launcher.rotate(aci,true);
				if(indic!=null) {indic.remove();}	
				target.attr("x",iop.x2-target.attr("width")/2);
				target.attr("y",iop.y2-target.attr("height")/2);
				indic=paper.path("M"+iop.x1+" "+iop.y1+"L"+iop.x2+" "+iop.y2+"").attr({fill:'#FFF',"stroke-width":5, stroke: "#fff", opacity: 1});
			}		
	}, false);
	document.addEventListener(jQuery.browser.mobile?'touchend':'mouseup', function(e) {
    e.preventDefault();
		if(down)
		{
				if(!jQuery.browser.mobile)
				{
				iop.x2=e.pageX;
				iop.y2=e.pageY;
				}
		target.remove();
		if(indic!=null) {indic.remove();}
		temizle();		
		aci=Math.atan((iop.y2-iop.y1)/(iop.x2-iop.x1))*180/Math.PI;
		if((iop.x2-iop.x1)<0)
		{
			aci+=180;
		}
		launcher.rotate(aci,true);
		bombx=(launcher.attr("x")+launcher.attr("width")/2)+sinus(90-launcher._.rt.deg)*launcher.attr("width")/3;
		bomby=(launcher.attr("y")+launcher.attr("height")/2)+sinus(launcher._.rt.deg)*launcher.attr("width")/3;
		bomb=paper.circle(bombx,bomby, 20).attr({fill:'#f00',stroke: "none", opacity: 1});
		bombfire=paper.image('fire.gif',bombx, bomby, 40, 80);
		bombfire.rotate(aci-90,true);
		//bomb=paper.circle(launcher.attr("x"),launcher.attr("y"), 20).attr({fill:'#EE8515', stroke: "none", opacity: 1}).drag(move,start,up);
		bomb.cap=20;
		bomb.spx=(iop.x2-iop.x1)/20;
		bomb.spy=(iop.y2-iop.y1)/20;
		intervalid=setInterval(init,100);
		down=false;
		}
	}, false);
};
</script>
</head>

<body>
<div id='canvas' style='position:absolute; left:0; top:0; width:100%; height:100%; background-image:url("./sky.gif");'>
</div>
<div id="time" style="background-color:gray; opacity:0.8;  position:absolute; border:2px solid white; color:white; right:5px; top:5px; padding:10px; font-size:20px; font-family:Tahoma;">
...
</div>
<div id="hits" style=" background-color:gray; opacity:0.8; position:absolute; border:2px solid white; color:white; left:5px; top:5px; font-size:20px; font-family:Tahoma;">
<div style="margin-left:5px;padding:4px; float:left;">Angle : <span id="angle">0</span></div>
<div style="margin-left:5px;padding:4px; float:left;">Thrust : <span id="thrust">0</span></div>
<div style="margin-right:5px;padding:4px;">Hits : <span id="nhits">0</span></div>
</div>

<div  style="position:absolute; right:15px; bottom:15px; font-size:20px; font-family:Tahoma;">
<a href="https://play.google.com/store/apps/details?id=com.ahmet.lunnar"><img src="and.png" /></a>
</div>

<div data-role="dialog" class=".ui-dialog" id="missed" data-title="Target Missed">
  <div data-role="content">
    <h3 class="sure-1">Target Missed</h3>
  </div>
</div>

<div data-role="dialog" class=".ui-dialog" id="hit" data-title="Target Hit!">
  <div data-role="content">
    <h3 class="sure-1">Target Hit!</h3>
    <h3 class="sure-2">Well Done!!</h3>
  </div>
</div>

<div data-role="dialog" class=".ui-dialog"  id="damn" data-title="Damn!">
  <div data-role="content">
    <h3 class="sure-1">Damn You!</h3>
    <h3 class="sure-2">You Hit the Moon!!</h3>
  </div>
</div>
<script>
$(document).ready(function(){
$(".ui-dialog").each(function() { $(this).dialog(); });
$(".ui-dialog").each(function() { $(this).hide(); });
});
</script>
</body>
</html>